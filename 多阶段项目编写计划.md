# å”¤é†’é—¹é’Ÿåº”ç”¨ - å¤šé˜¶æ®µé¡¹ç›®ç¼–å†™è®¡åˆ’

## ğŸ“‹ è®¡åˆ’æ¦‚è¿°

æœ¬æ–‡æ¡£å°†5å°æ—¶MVPå¼€å‘è®¡åˆ’æ‹†åˆ†ä¸ºå…·ä½“çš„ç¼–ç é˜¶æ®µï¼Œä¸ºå¼€å‘è€…æä¾›é€æ­¥å®æ–½çš„è¯¦ç»†æŒ‡å—ã€‚æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„äº¤ä»˜ç‰©ã€ä»£ç è¦æ±‚å’ŒéªŒæ”¶æ ‡å‡†ã€‚

---

## ğŸš€ é˜¶æ®µ1: é¡¹ç›®åˆå§‹åŒ–å’ŒåŸºç¡€æ¶æ„ (20åˆ†é’Ÿ)

### ç›®æ ‡
æ­å»ºé¡¹ç›®åŸºç¡€æ¡†æ¶ï¼Œé…ç½®å¼€å‘ç¯å¢ƒ

### å…·ä½“ä»»åŠ¡

#### 1.1 é¡¹ç›®åˆ›å»º (5åˆ†é’Ÿ)
```bash
# å®‰è£…Expo CLI
npm install -g expo-cli

# åˆ›å»ºé¡¹ç›®
expo init WakeUpAlarm --template blank
cd WakeUpAlarm

# å®‰è£…å¿…è¦ä¾èµ–
npm install @react-navigation/native @react-navigation/bottom-tabs
npm install react-native-screens react-native-safe-area-context
npm install @expo/vector-icons expo-av expo-sensors
npm install @react-native-async-storage/async-storage
```

#### 1.2 é¡¹ç›®ç»“æ„æ­å»º (10åˆ†é’Ÿ)
```
src/
â”œâ”€â”€ components/          # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ Button.js
â”‚   â”œâ”€â”€ TimeInput.js
â”‚   â””â”€â”€ ProgressBar.js
â”œâ”€â”€ screens/            # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ HomeScreen.js
â”‚   â”œâ”€â”€ SetAlarmScreen.js
â”‚   â”œâ”€â”€ TriggerScreen.js
â”‚   â””â”€â”€ StatsScreen.js
â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ alarmService.js
â”‚   â”œâ”€â”€ sensorService.js
â”‚   â””â”€â”€ storageService.js
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ timeUtils.js
â”‚   â””â”€â”€ constants.js
â””â”€â”€ styles/             # æ ·å¼æ–‡ä»¶
    â””â”€â”€ globalStyles.js
```

#### 1.3 å¯¼èˆªé…ç½® (5åˆ†é’Ÿ)
åˆ›å»ºåŸºç¡€å¯¼èˆªç»“æ„ï¼Œè¿æ¥å››ä¸ªä¸»è¦é¡µé¢

### äº¤ä»˜ç‰©
- [ ] é¡¹ç›®åˆ›å»ºå®Œæˆï¼Œå¯ä»¥è¿è¡Œ
- [ ] åŸºç¡€ç›®å½•ç»“æ„å»ºç«‹
- [ ] å¯¼èˆªæ¡†æ¶é…ç½®å®Œæˆ
- [ ] ä¾èµ–åŒ…å®‰è£…æ— é”™è¯¯

### éªŒæ”¶æ ‡å‡†
- `expo start` å‘½ä»¤æˆåŠŸè¿è¡Œ
- å¯ä»¥åœ¨æ¨¡æ‹Ÿå™¨/çœŸæœºä¸Šçœ‹åˆ°ç©ºç™½åº”ç”¨
- åŸºç¡€é¡µé¢åˆ‡æ¢åŠŸèƒ½æ­£å¸¸

---

## â° é˜¶æ®µ2: é—¹é’Ÿæ•°æ®æ¨¡å‹å’Œå­˜å‚¨ (20åˆ†é’Ÿ)

### ç›®æ ‡
å®ç°é—¹é’Ÿçš„æ•°æ®ç»“æ„å’Œæœ¬åœ°å­˜å‚¨åŠŸèƒ½

### å…·ä½“ä»»åŠ¡

#### 2.1 æ•°æ®æ¨¡å‹è®¾è®¡ (5åˆ†é’Ÿ)
```javascript
// utils/constants.js
export const ALARM_SCHEMA = {
  id: String,
  time: String,        // "HH:MM" æ ¼å¼
  isActive: Boolean,
  createdAt: Date,
  snoozeCount: Number,
  lastSnoozeTime: Date
};

export const STATS_SCHEMA = {
  date: String,        // "YYYY-MM-DD" æ ¼å¼
  wakeUpSuccess: Boolean,
  snoozeCount: Number,
  penaltyAmount: Number
};
```

#### 2.2 å­˜å‚¨æœåŠ¡å®ç° (10åˆ†é’Ÿ)
```javascript
// services/storageService.js
import AsyncStorage from '@react-native-async-storage/async-storage';

export class StorageService {
  static KEYS = {
    CURRENT_ALARM: 'current_alarm',
    STATS_DATA: 'stats_data'
  };

  static async saveAlarm(alarm) {
    // ä¿å­˜é—¹é’Ÿæ•°æ®
  }

  static async getAlarm() {
    // è·å–å½“å‰é—¹é’Ÿ
  }

  static async saveStats(stats) {
    // ä¿å­˜ç»Ÿè®¡æ•°æ®
  }

  static async getStats() {
    // è·å–ç»Ÿè®¡æ•°æ®
  }
}
```

#### 2.3 é—¹é’ŸæœåŠ¡åŸºç¡€ (5åˆ†é’Ÿ)
```javascript
// services/alarmService.js
export class AlarmService {
  static createAlarm(time) {
    // åˆ›å»ºæ–°é—¹é’Ÿ
  }

  static scheduleAlarm(alarm) {
    // è°ƒåº¦é—¹é’Ÿ
  }

  static cancelAlarm() {
    // å–æ¶ˆé—¹é’Ÿ
  }
}
```

### äº¤ä»˜ç‰©
- [ ] æ•°æ®æ¨¡å‹å®šä¹‰å®Œæˆ
- [ ] æœ¬åœ°å­˜å‚¨æœåŠ¡å®ç°
- [ ] é—¹é’ŸæœåŠ¡åŸºç¡€æ¡†æ¶
- [ ] æ•°æ®CRUDæ“ä½œå¯ç”¨

### éªŒæ”¶æ ‡å‡†
- å¯ä»¥åˆ›å»ºå’Œä¿å­˜é—¹é’Ÿæ•°æ®
- åº”ç”¨é‡å¯åæ•°æ®ä¸ä¸¢å¤±
- åŸºç¡€æ•°æ®æ“ä½œæ— æŠ¥é”™

---

## ğŸ¨ é˜¶æ®µ3: åŸºç¡€UIç•Œé¢å¼€å‘ (20åˆ†é’Ÿ)

### ç›®æ ‡
å®Œæˆä¸»è¦é¡µé¢çš„UIå¸ƒå±€å’ŒåŸºç¡€äº¤äº’

### å…·ä½“ä»»åŠ¡

#### 3.1 å…¨å±€æ ·å¼è®¾ç½® (5åˆ†é’Ÿ)
```javascript
// styles/globalStyles.js
import { StyleSheet } from 'react-native';

export const globalStyles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: '#000',
    paddingHorizontal: 20
  },
  title: {
    fontSize: 24,
    fontWeight: 'bold',
    color: '#fff',
    textAlign: 'center'
  },
  button: {
    backgroundColor: '#fff',
    padding: 15,
    borderRadius: 8,
    alignItems: 'center',
    marginVertical: 10
  },
  buttonText: {
    fontSize: 18,
    fontWeight: 'bold',
    color: '#000'
  }
});
```

#### 3.2 ä¸»é¡µé¢å¼€å‘ (8åˆ†é’Ÿ)
```javascript
// screens/HomeScreen.js
import React, { useState, useEffect } from 'react';
import { View, Text, TouchableOpacity } from 'react-native';

export default function HomeScreen({ navigation }) {
  const [currentAlarm, setCurrentAlarm] = useState(null);

  return (
    <View style={globalStyles.container}>
      <Text style={globalStyles.title}>å”¤é†’é—¹é’Ÿ</Text>

      {currentAlarm ? (
        <View style={styles.alarmDisplay}>
          <Text style={styles.nextAlarmText}>ä¸‹ä¸ªé—¹é’Ÿ</Text>
          <Text style={styles.alarmTime}>{currentAlarm.time}</Text>
          <TouchableOpacity
            style={styles.editButton}
            onPress={() => navigation.navigate('SetAlarm')}
          >
            <Text>ç¼–è¾‘é—¹é’Ÿ</Text>
          </TouchableOpacity>
        </View>
      ) : (
        <TouchableOpacity
          style={globalStyles.button}
          onPress={() => navigation.navigate('SetAlarm')}
        >
          <Text style={globalStyles.buttonText}>è®¾ç½®é—¹é’Ÿ</Text>
        </TouchableOpacity>
      )}

      <TouchableOpacity
        style={[globalStyles.button, { marginTop: 20 }]}
        onPress={() => navigation.navigate('Stats')}
      >
        <Text style={globalStyles.buttonText}>æŸ¥çœ‹ç»Ÿè®¡</Text>
      </TouchableOpacity>
    </View>
  );
}
```

#### 3.3 è®¾ç½®é—¹é’Ÿé¡µé¢ (7åˆ†é’Ÿ)
```javascript
// screens/SetAlarmScreen.js
import React, { useState } from 'react';
import { View, Text, TouchableOpacity } from 'react-native';

export default function SetAlarmScreen({ navigation }) {
  const [selectedTime, setSelectedTime] = useState(new Date());

  const handleSaveAlarm = () => {
    // ä¿å­˜é—¹é’Ÿé€»è¾‘
    navigation.goBack();
  };

  return (
    <View style={globalStyles.container}>
      <Text style={globalStyles.title}>è®¾ç½®é—¹é’Ÿ</Text>

      {/* æ—¶é—´é€‰æ‹©å™¨ */}
      <View style={styles.timePickerContainer}>
        {/* ç®€å•çš„æ—¶é—´è¾“å…¥ */}
      </View>

      <TouchableOpacity
        style={globalStyles.button}
        onPress={handleSaveAlarm}
      >
        <Text style={globalStyles.buttonText}>ä¿å­˜é—¹é’Ÿ</Text>
      </TouchableOpacity>
    </View>
  );
}
```

### äº¤ä»˜ç‰©
- [ ] å…¨å±€æ ·å¼ç³»ç»Ÿ
- [ ] ä¸»é¡µé¢UIå®Œæˆ
- [ ] è®¾ç½®é¡µé¢UIå®Œæˆ
- [ ] åŸºç¡€é¡µé¢å¯¼èˆªæ­£å¸¸

### éªŒæ”¶æ ‡å‡†
- UIç•Œé¢ç¾è§‚ï¼Œç¬¦åˆé»‘ç™½ç®€çº¦è®¾è®¡
- é¡µé¢åˆ‡æ¢æµç•…æ— å¡é¡¿
- æŒ‰é’®äº¤äº’å“åº”æ­£å¸¸

---

## â° é˜¶æ®µ4: é—¹é’Ÿè°ƒåº¦å’ŒéŸ³æ•ˆç³»ç»Ÿ (20åˆ†é’Ÿ)

### ç›®æ ‡
å®ç°é—¹é’Ÿçš„å®šæ—¶è§¦å‘å’ŒéŸ³æ•ˆæ’­æ”¾åŠŸèƒ½

### å…·ä½“ä»»åŠ¡

#### 4.1 é—¹é’Ÿè°ƒåº¦å®ç° (10åˆ†é’Ÿ)
```javascript
// services/alarmService.js (æ‰©å±•)
import * as Notifications from 'expo-notifications';

export class AlarmService {
  static async scheduleAlarm(alarm) {
    // è®¡ç®—è§¦å‘æ—¶é—´
    const trigger = new Date();
    const [hours, minutes] = alarm.time.split(':');
    trigger.setHours(hours, minutes, 0, 0);

    // å¦‚æœæ—¶é—´å·²è¿‡ï¼Œè®¾ç½®ä¸ºæ˜å¤©
    if (trigger <= new Date()) {
      trigger.setDate(trigger.getDate() + 1);
    }

    await Notifications.scheduleNotificationAsync({
      content: {
        title: "å”¤é†’é—¹é’Ÿ",
        body: "èµ·åºŠæ—¶é—´åˆ°äº†ï¼",
        sound: 'default',
      },
      trigger,
    });
  }

  static async cancelAllAlarms() {
    await Notifications.cancelAllScheduledNotificationsAsync();
  }
}
```

#### 4.2 éŸ³æ•ˆæ’­æ”¾ç³»ç»Ÿ (10åˆ†é’Ÿ)
```javascript
// services/audioService.js
import { Audio } from 'expo-av';

export class AudioService {
  static sound = null;

  static async playAlarmSound() {
    try {
      const { sound } = await Audio.Sound.createAsync(
        require('../assets/alarm-sound.mp3'),
        { isLooping: true }
      );
      this.sound = sound;
      await sound.playAsync();
    } catch (error) {
      console.log('æ’­æ”¾éŸ³æ•ˆå¤±è´¥:', error);
    }
  }

  static async stopAlarmSound() {
    if (this.sound) {
      await this.sound.stopAsync();
      await this.sound.unloadAsync();
      this.sound = null;
    }
  }
}
```

### äº¤ä»˜ç‰©
- [ ] é—¹é’Ÿè°ƒåº¦åŠŸèƒ½å®Œæˆ
- [ ] é€šçŸ¥æƒé™ç”³è¯·
- [ ] éŸ³æ•ˆæ’­æ”¾ç³»ç»Ÿ
- [ ] é—¹é’Ÿå–æ¶ˆåŠŸèƒ½

### éªŒæ”¶æ ‡å‡†
- é—¹é’Ÿå¯ä»¥å‡†æ—¶è§¦å‘
- éŸ³æ•ˆæ’­æ”¾æ­£å¸¸
- å¯ä»¥æ‰‹åŠ¨å–æ¶ˆé—¹é’Ÿ

---

## ğŸ“± é˜¶æ®µ5: ä¼ æ„Ÿå™¨é›†æˆå’Œæ‘‡æ™ƒæ£€æµ‹ (30åˆ†é’Ÿ)

### ç›®æ ‡
å®ç°æ‰‹æœºæ‘‡æ™ƒæ£€æµ‹åŠŸèƒ½ï¼Œä½œä¸ºé—¹é’Ÿå…³é—­çš„è§¦å‘æ¡ä»¶

### å…·ä½“ä»»åŠ¡

#### 5.1 ä¼ æ„Ÿå™¨æœåŠ¡æ­å»º (10åˆ†é’Ÿ)
```javascript
// services/sensorService.js
import { Accelerometer } from 'expo-sensors';

export class SensorService {
  static subscription = null;
  static isDetecting = false;
  static shakeThreshold = 2.5; // æ‘‡æ™ƒé˜ˆå€¼
  static shakeDuration = 20000; // 20ç§’
  static onShakeCallback = null;

  static startShakeDetection(callback) {
    this.onShakeCallback = callback;
    this.isDetecting = true;

    Accelerometer.setUpdateInterval(50); // 50Hzé‡‡æ ·

    this.subscription = Accelerometer.addListener(this.handleAccelerometerData);
  }

  static handleAccelerometerData = ({ x, y, z }) => {
    if (!this.isDetecting) return;

    const acceleration = Math.sqrt(x * x + y * y + z * z);

    if (acceleration > this.shakeThreshold) {
      this.onShakeCallback && this.onShakeCallback(acceleration);
    }
  };

  static stopShakeDetection() {
    this.isDetecting = false;
    this.subscription && this.subscription.remove();
    this.subscription = null;
  }
}
```

#### 5.2 æ‘‡æ™ƒæ£€æµ‹ç®—æ³• (10åˆ†é’Ÿ)
```javascript
// utils/shakeDetector.js
export class ShakeDetector {
  constructor(onComplete, onProgress) {
    this.onComplete = onComplete;
    this.onProgress = onProgress;
    this.shakeCount = 0;
    this.requiredShakes = 100; // éœ€è¦çš„æ‘‡æ™ƒæ¬¡æ•°
    this.startTime = null;
    this.duration = 20000; // 20ç§’
  }

  start() {
    this.startTime = Date.now();
    this.shakeCount = 0;

    SensorService.startShakeDetection(this.handleShake);

    // è®¾ç½®è¶…æ—¶
    this.timeout = setTimeout(() => {
      this.reset();
    }, this.duration);
  }

  handleShake = (acceleration) => {
    this.shakeCount++;
    const progress = Math.min(this.shakeCount / this.requiredShakes, 1);

    this.onProgress && this.onProgress(progress);

    if (progress >= 1) {
      this.complete();
    }
  };

  complete() {
    SensorService.stopShakeDetection();
    clearTimeout(this.timeout);
    this.onComplete && this.onComplete();
  }

  reset() {
    SensorService.stopShakeDetection();
    clearTimeout(this.timeout);
    this.shakeCount = 0;
  }
}
```

#### 5.3 æ‘‡æ™ƒè§¦å‘é¡µé¢ (10åˆ†é’Ÿ)
```javascript
// screens/TriggerScreen.js
import React, { useState, useEffect } from 'react';
import { View, Text, TouchableOpacity, Alert } from 'react-native';
import { ShakeDetector } from '../utils/shakeDetector';
import { AudioService } from '../services/audioService';

export default function TriggerScreen({ navigation }) {
  const [progress, setProgress] = useState(0);
  const [isShaking, setIsShaking] = useState(false);
  const [shakeDetector, setShakeDetector] = useState(null);

  useEffect(() => {
    // å¼€å§‹æ’­æ”¾é—¹é’ŸéŸ³æ•ˆ
    AudioService.playAlarmSound();

    return () => {
      // æ¸…ç†èµ„æº
      shakeDetector && shakeDetector.reset();
      AudioService.stopAlarmSound();
    };
  }, []);

  const startShakeDetection = () => {
    setIsShaking(true);
    const detector = new ShakeDetector(
      handleShakeComplete,
      handleShakeProgress
    );
    detector.start();
    setShakeDetector(detector);
  };

  const handleShakeProgress = (progress) => {
    setProgress(progress);
  };

  const handleShakeComplete = () => {
    AudioService.stopAlarmSound();
    Alert.alert('æˆåŠŸ', 'é—¹é’Ÿå·²å…³é—­ï¼', [
      { text: 'ç¡®å®š', onPress: () => navigation.navigate('Home') }
    ]);
  };

  const handleSnooze = () => {
    // è´ªç¡é€»è¾‘
    Alert.alert(
      'è´ªç¡è­¦å‘Š',
      'é€‰æ‹©è´ªç¡å°†æ‰£é™¤5å…ƒå¹¶æèµ ç»™æ…ˆå–„æœºæ„',
      [
        { text: 'å–æ¶ˆ', style: 'cancel' },
        { text: 'ç¡®è®¤è´ªç¡', onPress: confirmSnooze }
      ]
    );
  };

  const confirmSnooze = () => {
    // è®°å½•è´ªç¡è¡Œä¸º
    AudioService.stopAlarmSound();
    // 5åˆ†é’Ÿåé‡æ–°å“é“ƒ
    setTimeout(() => {
      navigation.navigate('Trigger');
    }, 5 * 60 * 1000);
    navigation.navigate('Home');
  };

  return (
    <View style={[globalStyles.container, styles.centerContent]}>
      <Text style={globalStyles.title}>æ‘‡æ™ƒå…³é—­é—¹é’Ÿ</Text>

      <View style={styles.progressContainer}>
        <Text style={styles.progressText}>
          è¿›åº¦: {Math.round(progress * 100)}%
        </Text>
        <View style={styles.progressBar}>
          <View style={[styles.progressFill, { width: `${progress * 100}%` }]} />
        </View>
      </View>

      {!isShaking ? (
        <TouchableOpacity
          style={globalStyles.button}
          onPress={startShakeDetection}
        >
          <Text style={globalStyles.buttonText}>å¼€å§‹æ‘‡æ™ƒ</Text>
        </TouchableOpacity>
      ) : (
        <Text style={styles.instruction}>ç”¨åŠ›æ‘‡æ™ƒæ‰‹æœº20ç§’!</Text>
      )}

      <TouchableOpacity
        style={[globalStyles.button, styles.snoozeButton]}
        onPress={handleSnooze}
      >
        <Text style={[globalStyles.buttonText, styles.snoozeText]}>è´ªç¡ (-5å…ƒ)</Text>
      </TouchableOpacity>
    </View>
  );
}
```

### äº¤ä»˜ç‰©
- [ ] ä¼ æ„Ÿå™¨æƒé™ç”³è¯·
- [ ] æ‘‡æ™ƒæ£€æµ‹ç®—æ³•å®ç°
- [ ] æ‘‡æ™ƒè§¦å‘é¡µé¢å®Œæˆ
- [ ] è¿›åº¦æ˜¾ç¤ºåŠŸèƒ½

### éªŒæ”¶æ ‡å‡†
- æ‘‡æ™ƒæ£€æµ‹å‡†ç¡®ç‡>90%
- è¿›åº¦æ˜¾ç¤ºå®æ—¶æ›´æ–°
- å®Œæˆæ‘‡æ™ƒåé—¹é’ŸæˆåŠŸå…³é—­

---

## ğŸ’° é˜¶æ®µ6: è´ªç¡æƒ©ç½šæœºåˆ¶ (20åˆ†é’Ÿ)

### ç›®æ ‡
å®ç°æ¨¡æ‹Ÿè´ªç¡æ‰£æ¬¾å’Œè®°å½•åŠŸèƒ½

### å…·ä½“ä»»åŠ¡

#### 6.1 è´ªç¡è®°å½•æœåŠ¡ (10åˆ†é’Ÿ)
```javascript
// services/penaltyService.js
import { StorageService } from './storageService';

export class PenaltyService {
  static penaltyAmount = 5; // å›ºå®š5å…ƒæƒ©ç½š

  static async recordSnooze(alarmId) {
    const today = new Date().toISOString().split('T')[0];
    let stats = await StorageService.getStats() || {};

    if (!stats[today]) {
      stats[today] = {
        date: today,
        wakeUpSuccess: false,
        snoozeCount: 0,
        penaltyAmount: 0
      };
    }

    stats[today].snoozeCount += 1;
    stats[today].penaltyAmount += this.penaltyAmount;

    await StorageService.saveStats(stats);

    return {
      snoozeCount: stats[today].snoozeCount,
      totalPenalty: stats[today].penaltyAmount
    };
  }

  static async recordWakeUpSuccess() {
    const today = new Date().toISOString().split('T')[0];
    let stats = await StorageService.getStats() || {};

    if (!stats[today]) {
      stats[today] = {
        date: today,
        wakeUpSuccess: true,
        snoozeCount: 0,
        penaltyAmount: 0
      };
    } else {
      stats[today].wakeUpSuccess = true;
    }

    await StorageService.saveStats(stats);
  }
}
```

#### 6.2 æ›´æ–°æ‘‡æ™ƒè§¦å‘é¡µé¢ (10åˆ†é’Ÿ)
```javascript
// åœ¨TriggerScreen.jsä¸­æ·»åŠ è´ªç¡å¤„ç†é€»è¾‘
const confirmSnooze = async () => {
  try {
    const result = await PenaltyService.recordSnooze(currentAlarm.id);

    AudioService.stopAlarmSound();

    Alert.alert(
      'è´ªç¡å·²è®°å½•',
      `å·²è®°å½•è´ªç¡ ${result.snoozeCount} æ¬¡\nä»Šæ—¥ç´¯è®¡"æ‰£æ¬¾": ${result.totalPenalty}å…ƒ`,
      [{ text: 'ç¡®å®š', onPress: () => navigation.navigate('Home') }]
    );

    // æ¨¡æ‹Ÿ5åˆ†é’Ÿåé‡æ–°å“é“ƒ
    setTimeout(() => {
      navigation.navigate('Trigger');
    }, 5 * 60 * 1000);

  } catch (error) {
    console.error('è®°å½•è´ªç¡å¤±è´¥:', error);
  }
};

const handleShakeComplete = async () => {
  await PenaltyService.recordWakeUpSuccess();
  AudioService.stopAlarmSound();

  Alert.alert('æˆåŠŸ', 'èµ·åºŠæˆåŠŸï¼ä»Šå¤©æ²¡æœ‰è´ªç¡æ‰£æ¬¾ã€‚', [
    { text: 'ç¡®å®š', onPress: () => navigation.navigate('Home') }
  ]);
};
```

### äº¤ä»˜ç‰©
- [ ] è´ªç¡è®°å½•æœåŠ¡å®Œæˆ
- [ ] æ¨¡æ‹Ÿæ‰£æ¬¾æ˜¾ç¤º
- [ ] æˆåŠŸèµ·åºŠè®°å½•
- [ ] æ•°æ®ç»Ÿè®¡æ›´æ–°

### éªŒæ”¶æ ‡å‡†
- è´ªç¡è¡Œä¸ºæ­£ç¡®è®°å½•
- "æ‰£æ¬¾"é‡‘é¢ç´¯è®¡å‡†ç¡®
- æˆåŠŸèµ·åºŠæœ‰æ­£å‘åé¦ˆ

---

## ğŸ“Š é˜¶æ®µ7: ç»Ÿè®¡é¡µé¢å’Œæ•°æ®å±•ç¤º (30åˆ†é’Ÿ)

### ç›®æ ‡
å®ç°ç”¨æˆ·æ•°æ®ç»Ÿè®¡å’Œå±•ç¤ºåŠŸèƒ½

### å…·ä½“ä»»åŠ¡

#### 7.1 ç»Ÿè®¡æ•°æ®è®¡ç®— (10åˆ†é’Ÿ)
```javascript
// services/statsService.js
import { StorageService } from './storageService';

export class StatsService {
  static async getWeeklyStats() {
    const stats = await StorageService.getStats() || {};
    const today = new Date();
    const weeklyData = [];

    for (let i = 6; i >= 0; i--) {
      const date = new Date(today);
      date.setDate(date.getDate() - i);
      const dateStr = date.toISOString().split('T')[0];

      weeklyData.push({
        date: dateStr,
        dayName: date.toLocaleDateString('zh-CN', { weekday: 'short' }),
        ...stats[dateStr] || {
          wakeUpSuccess: null,
          snoozeCount: 0,
          penaltyAmount: 0
        }
      });
    }

    return weeklyData;
  }

  static async getTotalStats() {
    const stats = await StorageService.getStats() || {};
    let totalPenalty = 0;
    let totalSnoozes = 0;
    let successDays = 0;
    let totalDays = 0;

    Object.values(stats).forEach(day => {
      totalPenalty += day.penaltyAmount || 0;
      totalSnoozes += day.snoozeCount || 0;
      if (day.wakeUpSuccess) successDays++;
      if (day.wakeUpSuccess !== null) totalDays++;
    });

    return {
      totalPenalty,
      totalSnoozes,
      successRate: totalDays > 0 ? (successDays / totalDays * 100).toFixed(1) : 0,
      successDays,
      totalDays
    };
  }
}
```

#### 7.2 ç»Ÿè®¡é¡µé¢UI (20åˆ†é’Ÿ)
```javascript
// screens/StatsScreen.js
import React, { useState, useEffect } from 'react';
import { View, Text, ScrollView, RefreshControl } from 'react-native';
import { StatsService } from '../services/statsService';

export default function StatsScreen() {
  const [weeklyStats, setWeeklyStats] = useState([]);
  const [totalStats, setTotalStats] = useState({});
  const [refreshing, setRefreshing] = useState(false);

  useEffect(() => {
    loadStats();
  }, []);

  const loadStats = async () => {
    try {
      const weekly = await StatsService.getWeeklyStats();
      const total = await StatsService.getTotalStats();
      setWeeklyStats(weekly);
      setTotalStats(total);
    } catch (error) {
      console.error('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
    }
  };

  const onRefresh = async () => {
    setRefreshing(true);
    await loadStats();
    setRefreshing(false);
  };

  const renderWeeklyItem = (item) => (
    <View key={item.date} style={styles.dayItem}>
      <Text style={styles.dayName}>{item.dayName}</Text>
      <View style={[
        styles.statusIndicator,
        { backgroundColor: getStatusColor(item.wakeUpSuccess) }
      ]} />
      <Text style={styles.snoozeCount}>
        {item.snoozeCount > 0 ? `${item.snoozeCount}æ¬¡` : '-'}
      </Text>
      <Text style={styles.penalty}>
        {item.penaltyAmount > 0 ? `Â¥${item.penaltyAmount}` : '-'}
      </Text>
    </View>
  );

  const getStatusColor = (success) => {
    if (success === true) return '#4CAF50'; // ç»¿è‰² - æˆåŠŸ
    if (success === false) return '#F44336'; // çº¢è‰² - å¤±è´¥
    return '#9E9E9E'; // ç°è‰² - æ— æ•°æ®
  };

  return (
    <ScrollView
      style={globalStyles.container}
      refreshControl={
        <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />
      }
    >
      <Text style={globalStyles.title}>èµ·åºŠç»Ÿè®¡</Text>

      {/* æ€»ä½“ç»Ÿè®¡ */}
      <View style={styles.summaryCard}>
        <Text style={styles.cardTitle}>æ€»ä½“æ•°æ®</Text>
        <View style={styles.summaryRow}>
          <View style={styles.summaryItem}>
            <Text style={styles.summaryValue}>{totalStats.successRate}%</Text>
            <Text style={styles.summaryLabel}>æˆåŠŸç‡</Text>
          </View>
          <View style={styles.summaryItem}>
            <Text style={styles.summaryValue}>{totalStats.totalSnoozes}</Text>
            <Text style={styles.summaryLabel}>æ€»è´ªç¡æ¬¡æ•°</Text>
          </View>
          <View style={styles.summaryItem}>
            <Text style={[styles.summaryValue, styles.penaltyValue]}>
              Â¥{totalStats.totalPenalty}
            </Text>
            <Text style={styles.summaryLabel}>ç´¯è®¡"æ‰£æ¬¾"</Text>
          </View>
        </View>
      </View>

      {/* æœ¬å‘¨æ•°æ® */}
      <View style={styles.weeklyCard}>
        <Text style={styles.cardTitle}>æœ¬å‘¨è®°å½•</Text>
        <View style={styles.weeklyHeader}>
          <Text style={styles.headerText}>æ—¥æœŸ</Text>
          <Text style={styles.headerText}>çŠ¶æ€</Text>
          <Text style={styles.headerText}>è´ªç¡</Text>
          <Text style={styles.headerText}>"æ‰£æ¬¾"</Text>
        </View>
        {weeklyStats.map(renderWeeklyItem)}
      </View>

      {/* ä½¿ç”¨è¯´æ˜ */}
      <View style={styles.infoCard}>
        <Text style={styles.cardTitle}>è¯´æ˜</Text>
        <Text style={styles.infoText}>
          â€¢ ç»¿è‰²: æˆåŠŸèµ·åºŠï¼Œæ— è´ªç¡{'\n'}
          â€¢ çº¢è‰²: æœ‰è´ªç¡è¡Œä¸º{'\n'}
          â€¢ ç°è‰²: æ— é—¹é’Ÿè®°å½•{'\n'}
          â€¢ æ‰£æ¬¾ä¸ºæ¨¡æ‹Ÿæ˜¾ç¤ºï¼Œä¸ä¼šçœŸå®æ‰£è´¹
        </Text>
      </View>
    </ScrollView>
  );
}

const styles = StyleSheet.create({
  summaryCard: {
    backgroundColor: '#1a1a1a',
    borderRadius: 8,
    padding: 20,
    marginVertical: 10,
  },
  cardTitle: {
    color: '#fff',
    fontSize: 18,
    fontWeight: 'bold',
    marginBottom: 15,
  },
  summaryRow: {
    flexDirection: 'row',
    justifyContent: 'space-around',
  },
  summaryItem: {
    alignItems: 'center',
  },
  summaryValue: {
    color: '#fff',
    fontSize: 24,
    fontWeight: 'bold',
  },
  penaltyValue: {
    color: '#F44336',
  },
  summaryLabel: {
    color: '#ccc',
    fontSize: 12,
    marginTop: 5,
  },
  weeklyCard: {
    backgroundColor: '#1a1a1a',
    borderRadius: 8,
    padding: 20,
    marginVertical: 10,
  },
  weeklyHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    paddingBottom: 10,
    borderBottomWidth: 1,
    borderBottomColor: '#333',
    marginBottom: 10,
  },
  headerText: {
    color: '#ccc',
    fontSize: 14,
    fontWeight: 'bold',
    flex: 1,
    textAlign: 'center',
  },
  dayItem: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingVertical: 8,
  },
  dayName: {
    color: '#fff',
    fontSize: 14,
    flex: 1,
    textAlign: 'center',
  },
  statusIndicator: {
    width: 20,
    height: 20,
    borderRadius: 10,
    flex: 1,
    alignSelf: 'center',
  },
  snoozeCount: {
    color: '#fff',
    fontSize: 14,
    flex: 1,
    textAlign: 'center',
  },
  penalty: {
    color: '#F44336',
    fontSize: 14,
    flex: 1,
    textAlign: 'center',
  },
  infoCard: {
    backgroundColor: '#1a1a1a',
    borderRadius: 8,
    padding: 20,
    marginVertical: 10,
  },
  infoText: {
    color: '#ccc',
    fontSize: 14,
    lineHeight: 20,
  },
});
```

### äº¤ä»˜ç‰©
- [ ] ç»Ÿè®¡æ•°æ®è®¡ç®—æœåŠ¡
- [ ] å‘¨æ•°æ®å¯è§†åŒ–
- [ ] æ€»ä½“æ•°æ®æ‘˜è¦
- [ ] æ•°æ®åˆ·æ–°åŠŸèƒ½

### éªŒæ”¶æ ‡å‡†
- ç»Ÿè®¡æ•°æ®è®¡ç®—å‡†ç¡®
- å›¾è¡¨æ˜¾ç¤ºæ¸…æ™°æ˜“æ‡‚
- æ•°æ®å®æ—¶æ›´æ–°
- ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½æ­£å¸¸

---

## ğŸ”§ é˜¶æ®µ8: æ•´ä½“æµ‹è¯•å’Œä¼˜åŒ– (30åˆ†é’Ÿ)

### ç›®æ ‡
å…¨é¢æµ‹è¯•åº”ç”¨åŠŸèƒ½ï¼Œä¿®å¤bugï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

### å…·ä½“ä»»åŠ¡

#### 8.1 åŠŸèƒ½æµ‹è¯• (15åˆ†é’Ÿ)
æµ‹è¯•æ¸…å•ï¼š
- [ ] è®¾ç½®é—¹é’Ÿ â†’ å‡†æ—¶è§¦å‘
- [ ] æ‘‡æ™ƒæ£€æµ‹ â†’ è¿›åº¦æ˜¾ç¤º â†’ æˆåŠŸå…³é—­
- [ ] è´ªç¡æ“ä½œ â†’ è®°å½•æ•°æ® â†’ é‡æ–°å“é“ƒ
- [ ] ç»Ÿè®¡é¡µé¢ â†’ æ•°æ®å‡†ç¡® â†’ åˆ·æ–°æ­£å¸¸
- [ ] é¡µé¢å¯¼èˆª â†’ æ— å¡é¡¿ â†’ æ— æŠ¥é”™
- [ ] æ•°æ®æŒä¹…åŒ– â†’ é‡å¯åº”ç”¨ â†’ æ•°æ®ä¿ç•™

#### 8.2 ç”¨æˆ·ä½“éªŒä¼˜åŒ– (10åˆ†é’Ÿ)
- æ·»åŠ åŠ è½½çŠ¶æ€
- ä¼˜åŒ–æŒ‰é’®åé¦ˆ
- å¢åŠ æ“ä½œç¡®è®¤
- æ”¹å–„é”™è¯¯æç¤º
- ä¼˜åŒ–ç•Œé¢å“åº”

#### 8.3 æ€§èƒ½ä¼˜åŒ– (5åˆ†é’Ÿ)
- å‡å°‘ä¸å¿…è¦çš„é‡æ¸²æŸ“
- ä¼˜åŒ–ä¼ æ„Ÿå™¨ç›‘å¬
- æ¸…ç†æœªä½¿ç”¨çš„èµ„æº
- æ£€æŸ¥å†…å­˜æ³„æ¼

### äº¤ä»˜ç‰©
- [ ] åŠŸèƒ½æµ‹è¯•æŠ¥å‘Š
- [ ] Bugä¿®å¤å®Œæˆ
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- [ ] æ€§èƒ½ä¼˜åŒ–å®Œæˆ
- [ ] åº”ç”¨å‘å¸ƒå‡†å¤‡

### éªŒæ”¶æ ‡å‡†
- æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸å·¥ä½œ
- æ— ä¸¥é‡bugå’Œå´©æºƒ
- ç•Œé¢å“åº”æµç•…
- å¯ä»¥æ‰“åŒ…å‘å¸ƒ

---

## ğŸ“‹ é¡¹ç›®å®Œæˆæ£€æŸ¥å•

### æ ¸å¿ƒåŠŸèƒ½éªŒæ”¶
- [ ] **é—¹é’Ÿè®¾ç½®**: å¯ä»¥åˆ›å»ºå’Œä¿å­˜é—¹é’Ÿ
- [ ] **å®šæ—¶è§¦å‘**: é—¹é’Ÿå‡†æ—¶å“èµ·å¹¶æ’­æ”¾éŸ³æ•ˆ
- [ ] **æ‘‡æ™ƒæ£€æµ‹**: æ‘‡æ™ƒ20ç§’å¯å…³é—­é—¹é’Ÿ
- [ ] **è´ªç¡æƒ©ç½š**: è´ªç¡ä¼šæ˜¾ç¤ºæ‰£æ¬¾å¹¶è®°å½•
- [ ] **æ•°æ®ç»Ÿè®¡**: å¯æŸ¥çœ‹èµ·åºŠè®°å½•å’Œ"æ‰£æ¬¾"ç»Ÿè®¡
- [ ] **æ•°æ®æŒä¹…**: åº”ç”¨é‡å¯åæ•°æ®ä¸ä¸¢å¤±

### æŠ€æœ¯æŒ‡æ ‡éªŒæ”¶
- [ ] **å“åº”é€Ÿåº¦**: é¡µé¢åˆ‡æ¢<500ms
- [ ] **æ£€æµ‹ç²¾åº¦**: æ‘‡æ™ƒæ£€æµ‹å‡†ç¡®ç‡>90%
- [ ] **ç¨³å®šæ€§**: è¿ç»­ä½¿ç”¨æ— å´©æºƒ
- [ ] **å…¼å®¹æ€§**: æ”¯æŒiOSå’ŒAndroid
- [ ] **èµ„æºå ç”¨**: å†…å­˜ä½¿ç”¨<100MB

### ç”¨æˆ·ä½“éªŒéªŒæ”¶
- [ ] **ç•Œé¢å‹å¥½**: é»‘ç™½ç®€çº¦è®¾è®¡
- [ ] **æ“ä½œç®€å•**: ä¸»è¦åŠŸèƒ½3æ­¥å†…å®Œæˆ
- [ ] **åé¦ˆåŠæ—¶**: æ“ä½œæœ‰å³æ—¶åé¦ˆ
- [ ] **é”™è¯¯å¤„ç†**: å¼‚å¸¸æƒ…å†µæœ‰å‹å¥½æç¤º

---

## ğŸš€ åç»­æ‰©å±•è®¡åˆ’

### ç¬¬ä¸€æ¬¡è¿­ä»£ (å®ŒæˆMVPå)
- æ·»åŠ GPSè·ç¦»æ£€æµ‹åŠŸèƒ½
- å®ç°çœŸå®æ”¯ä»˜ç³»ç»Ÿé›†æˆ
- å¢åŠ æ›´å¤šé—¹é’Ÿé“ƒå£°
- æ”¯æŒå¤šä¸ªé—¹é’Ÿè®¾ç½®

### ç¬¬äºŒæ¬¡è¿­ä»£
- å¼€å‘åç«¯APIæœåŠ¡
- å®ç°ç”¨æˆ·è´¦å·ç³»ç»Ÿ
- æ·»åŠ äº‘ç«¯æ•°æ®åŒæ­¥
- å¢åŠ ç¤¾äº¤åˆ†äº«åŠŸèƒ½

### ç¬¬ä¸‰æ¬¡è¿­ä»£
- æ™ºèƒ½ä¹ æƒ¯åˆ†æ
- ä¸ªæ€§åŒ–å»ºè®®æ¨è
- è¯¦ç»†æ•°æ®å›¾è¡¨
- æˆå°±ç³»ç»Ÿå’Œå¥–åŠ±

---

*æœ¬å¤šé˜¶æ®µç¼–å†™è®¡åˆ’ä¸º5å°æ—¶MVPå¼€å‘æä¾›äº†è¯¦ç»†çš„å®æ–½è·¯å¾„ï¼Œç¡®ä¿åœ¨æœ‰é™æ—¶é—´å†…å®Œæˆæ ¸å¿ƒåŠŸèƒ½çš„æŠ€æœ¯éªŒè¯ã€‚*