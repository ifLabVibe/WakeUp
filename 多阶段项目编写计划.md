# 唤醒闹钟应用 - 多阶段项目编写计划

## 📋 计划概述

本文档将5小时MVP开发计划拆分为具体的编码阶段，为开发者提供逐步实施的详细指南。每个阶段都有明确的交付物、代码要求和验收标准。

---

## 🚀 阶段1: 项目初始化和基础架构 (20分钟)

### 目标
搭建项目基础框架，配置开发环境

### 具体任务

#### 1.1 项目创建 (5分钟)
```bash
# 安装Expo CLI
npm install -g expo-cli

# 创建项目
expo init WakeUpAlarm --template blank
cd WakeUpAlarm

# 安装必要依赖
npm install @react-navigation/native @react-navigation/bottom-tabs
npm install react-native-screens react-native-safe-area-context
npm install @expo/vector-icons expo-av expo-sensors
npm install @react-native-async-storage/async-storage
```

#### 1.2 项目结构搭建 (10分钟)
```
src/
├── components/          # 可复用组件
│   ├── Button.js
│   ├── TimeInput.js
│   └── ProgressBar.js
├── screens/            # 页面组件
│   ├── HomeScreen.js
│   ├── SetAlarmScreen.js
│   ├── TriggerScreen.js
│   └── StatsScreen.js
├── services/           # 业务逻辑
│   ├── alarmService.js
│   ├── sensorService.js
│   └── storageService.js
├── utils/              # 工具函数
│   ├── timeUtils.js
│   └── constants.js
└── styles/             # 样式文件
    └── globalStyles.js
```

#### 1.3 导航配置 (5分钟)
创建基础导航结构，连接四个主要页面

### 交付物
- [ ] 项目创建完成，可以运行
- [ ] 基础目录结构建立
- [ ] 导航框架配置完成
- [ ] 依赖包安装无错误

### 验收标准
- `expo start` 命令成功运行
- 可以在模拟器/真机上看到空白应用
- 基础页面切换功能正常

---

## ⏰ 阶段2: 闹钟数据模型和存储 (20分钟)

### 目标
实现闹钟的数据结构和本地存储功能

### 具体任务

#### 2.1 数据模型设计 (5分钟)
```javascript
// utils/constants.js
export const ALARM_SCHEMA = {
  id: String,
  time: String,        // "HH:MM" 格式
  isActive: Boolean,
  createdAt: Date,
  snoozeCount: Number,
  lastSnoozeTime: Date
};

export const STATS_SCHEMA = {
  date: String,        // "YYYY-MM-DD" 格式
  wakeUpSuccess: Boolean,
  snoozeCount: Number,
  penaltyAmount: Number
};
```

#### 2.2 存储服务实现 (10分钟)
```javascript
// services/storageService.js
import AsyncStorage from '@react-native-async-storage/async-storage';

export class StorageService {
  static KEYS = {
    CURRENT_ALARM: 'current_alarm',
    STATS_DATA: 'stats_data'
  };

  static async saveAlarm(alarm) {
    // 保存闹钟数据
  }

  static async getAlarm() {
    // 获取当前闹钟
  }

  static async saveStats(stats) {
    // 保存统计数据
  }

  static async getStats() {
    // 获取统计数据
  }
}
```

#### 2.3 闹钟服务基础 (5分钟)
```javascript
// services/alarmService.js
export class AlarmService {
  static createAlarm(time) {
    // 创建新闹钟
  }

  static scheduleAlarm(alarm) {
    // 调度闹钟
  }

  static cancelAlarm() {
    // 取消闹钟
  }
}
```

### 交付物
- [ ] 数据模型定义完成
- [ ] 本地存储服务实现
- [ ] 闹钟服务基础框架
- [ ] 数据CRUD操作可用

### 验收标准
- 可以创建和保存闹钟数据
- 应用重启后数据不丢失
- 基础数据操作无报错

---

## 🎨 阶段3: 基础UI界面开发 (20分钟)

### 目标
完成主要页面的UI布局和基础交互

### 具体任务

#### 3.1 全局样式设置 (5分钟)
```javascript
// styles/globalStyles.js
import { StyleSheet } from 'react-native';

export const globalStyles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: '#000',
    paddingHorizontal: 20
  },
  title: {
    fontSize: 24,
    fontWeight: 'bold',
    color: '#fff',
    textAlign: 'center'
  },
  button: {
    backgroundColor: '#fff',
    padding: 15,
    borderRadius: 8,
    alignItems: 'center',
    marginVertical: 10
  },
  buttonText: {
    fontSize: 18,
    fontWeight: 'bold',
    color: '#000'
  }
});
```

#### 3.2 主页面开发 (8分钟)
```javascript
// screens/HomeScreen.js
import React, { useState, useEffect } from 'react';
import { View, Text, TouchableOpacity } from 'react-native';

export default function HomeScreen({ navigation }) {
  const [currentAlarm, setCurrentAlarm] = useState(null);

  return (
    <View style={globalStyles.container}>
      <Text style={globalStyles.title}>唤醒闹钟</Text>

      {currentAlarm ? (
        <View style={styles.alarmDisplay}>
          <Text style={styles.nextAlarmText}>下个闹钟</Text>
          <Text style={styles.alarmTime}>{currentAlarm.time}</Text>
          <TouchableOpacity
            style={styles.editButton}
            onPress={() => navigation.navigate('SetAlarm')}
          >
            <Text>编辑闹钟</Text>
          </TouchableOpacity>
        </View>
      ) : (
        <TouchableOpacity
          style={globalStyles.button}
          onPress={() => navigation.navigate('SetAlarm')}
        >
          <Text style={globalStyles.buttonText}>设置闹钟</Text>
        </TouchableOpacity>
      )}

      <TouchableOpacity
        style={[globalStyles.button, { marginTop: 20 }]}
        onPress={() => navigation.navigate('Stats')}
      >
        <Text style={globalStyles.buttonText}>查看统计</Text>
      </TouchableOpacity>
    </View>
  );
}
```

#### 3.3 设置闹钟页面 (7分钟)
```javascript
// screens/SetAlarmScreen.js
import React, { useState } from 'react';
import { View, Text, TouchableOpacity } from 'react-native';

export default function SetAlarmScreen({ navigation }) {
  const [selectedTime, setSelectedTime] = useState(new Date());

  const handleSaveAlarm = () => {
    // 保存闹钟逻辑
    navigation.goBack();
  };

  return (
    <View style={globalStyles.container}>
      <Text style={globalStyles.title}>设置闹钟</Text>

      {/* 时间选择器 */}
      <View style={styles.timePickerContainer}>
        {/* 简单的时间输入 */}
      </View>

      <TouchableOpacity
        style={globalStyles.button}
        onPress={handleSaveAlarm}
      >
        <Text style={globalStyles.buttonText}>保存闹钟</Text>
      </TouchableOpacity>
    </View>
  );
}
```

### 交付物
- [ ] 全局样式系统
- [ ] 主页面UI完成
- [ ] 设置页面UI完成
- [ ] 基础页面导航正常

### 验收标准
- UI界面美观，符合黑白简约设计
- 页面切换流畅无卡顿
- 按钮交互响应正常

---

## ⏰ 阶段4: 闹钟调度和音效系统 (20分钟)

### 目标
实现闹钟的定时触发和音效播放功能

### 具体任务

#### 4.1 闹钟调度实现 (10分钟)
```javascript
// services/alarmService.js (扩展)
import * as Notifications from 'expo-notifications';

export class AlarmService {
  static async scheduleAlarm(alarm) {
    // 计算触发时间
    const trigger = new Date();
    const [hours, minutes] = alarm.time.split(':');
    trigger.setHours(hours, minutes, 0, 0);

    // 如果时间已过，设置为明天
    if (trigger <= new Date()) {
      trigger.setDate(trigger.getDate() + 1);
    }

    await Notifications.scheduleNotificationAsync({
      content: {
        title: "唤醒闹钟",
        body: "起床时间到了！",
        sound: 'default',
      },
      trigger,
    });
  }

  static async cancelAllAlarms() {
    await Notifications.cancelAllScheduledNotificationsAsync();
  }
}
```

#### 4.2 音效播放系统 (10分钟)
```javascript
// services/audioService.js
import { Audio } from 'expo-av';

export class AudioService {
  static sound = null;

  static async playAlarmSound() {
    try {
      const { sound } = await Audio.Sound.createAsync(
        require('../assets/alarm-sound.mp3'),
        { isLooping: true }
      );
      this.sound = sound;
      await sound.playAsync();
    } catch (error) {
      console.log('播放音效失败:', error);
    }
  }

  static async stopAlarmSound() {
    if (this.sound) {
      await this.sound.stopAsync();
      await this.sound.unloadAsync();
      this.sound = null;
    }
  }
}
```

### 交付物
- [ ] 闹钟调度功能完成
- [ ] 通知权限申请
- [ ] 音效播放系统
- [ ] 闹钟取消功能

### 验收标准
- 闹钟可以准时触发
- 音效播放正常
- 可以手动取消闹钟

---

## 📱 阶段5: 传感器集成和摇晃检测 (30分钟)

### 目标
实现手机摇晃检测功能，作为闹钟关闭的触发条件

### 具体任务

#### 5.1 传感器服务搭建 (10分钟)
```javascript
// services/sensorService.js
import { Accelerometer } from 'expo-sensors';

export class SensorService {
  static subscription = null;
  static isDetecting = false;
  static shakeThreshold = 2.5; // 摇晃阈值
  static shakeDuration = 20000; // 20秒
  static onShakeCallback = null;

  static startShakeDetection(callback) {
    this.onShakeCallback = callback;
    this.isDetecting = true;

    Accelerometer.setUpdateInterval(50); // 50Hz采样

    this.subscription = Accelerometer.addListener(this.handleAccelerometerData);
  }

  static handleAccelerometerData = ({ x, y, z }) => {
    if (!this.isDetecting) return;

    const acceleration = Math.sqrt(x * x + y * y + z * z);

    if (acceleration > this.shakeThreshold) {
      this.onShakeCallback && this.onShakeCallback(acceleration);
    }
  };

  static stopShakeDetection() {
    this.isDetecting = false;
    this.subscription && this.subscription.remove();
    this.subscription = null;
  }
}
```

#### 5.2 摇晃检测算法 (10分钟)
```javascript
// utils/shakeDetector.js
export class ShakeDetector {
  constructor(onComplete, onProgress) {
    this.onComplete = onComplete;
    this.onProgress = onProgress;
    this.shakeCount = 0;
    this.requiredShakes = 100; // 需要的摇晃次数
    this.startTime = null;
    this.duration = 20000; // 20秒
  }

  start() {
    this.startTime = Date.now();
    this.shakeCount = 0;

    SensorService.startShakeDetection(this.handleShake);

    // 设置超时
    this.timeout = setTimeout(() => {
      this.reset();
    }, this.duration);
  }

  handleShake = (acceleration) => {
    this.shakeCount++;
    const progress = Math.min(this.shakeCount / this.requiredShakes, 1);

    this.onProgress && this.onProgress(progress);

    if (progress >= 1) {
      this.complete();
    }
  };

  complete() {
    SensorService.stopShakeDetection();
    clearTimeout(this.timeout);
    this.onComplete && this.onComplete();
  }

  reset() {
    SensorService.stopShakeDetection();
    clearTimeout(this.timeout);
    this.shakeCount = 0;
  }
}
```

#### 5.3 摇晃触发页面 (10分钟)
```javascript
// screens/TriggerScreen.js
import React, { useState, useEffect } from 'react';
import { View, Text, TouchableOpacity, Alert } from 'react-native';
import { ShakeDetector } from '../utils/shakeDetector';
import { AudioService } from '../services/audioService';

export default function TriggerScreen({ navigation }) {
  const [progress, setProgress] = useState(0);
  const [isShaking, setIsShaking] = useState(false);
  const [shakeDetector, setShakeDetector] = useState(null);

  useEffect(() => {
    // 开始播放闹钟音效
    AudioService.playAlarmSound();

    return () => {
      // 清理资源
      shakeDetector && shakeDetector.reset();
      AudioService.stopAlarmSound();
    };
  }, []);

  const startShakeDetection = () => {
    setIsShaking(true);
    const detector = new ShakeDetector(
      handleShakeComplete,
      handleShakeProgress
    );
    detector.start();
    setShakeDetector(detector);
  };

  const handleShakeProgress = (progress) => {
    setProgress(progress);
  };

  const handleShakeComplete = () => {
    AudioService.stopAlarmSound();
    Alert.alert('成功', '闹钟已关闭！', [
      { text: '确定', onPress: () => navigation.navigate('Home') }
    ]);
  };

  const handleSnooze = () => {
    // 贪睡逻辑
    Alert.alert(
      '贪睡警告',
      '选择贪睡将扣除5元并捐赠给慈善机构',
      [
        { text: '取消', style: 'cancel' },
        { text: '确认贪睡', onPress: confirmSnooze }
      ]
    );
  };

  const confirmSnooze = () => {
    // 记录贪睡行为
    AudioService.stopAlarmSound();
    // 5分钟后重新响铃
    setTimeout(() => {
      navigation.navigate('Trigger');
    }, 5 * 60 * 1000);
    navigation.navigate('Home');
  };

  return (
    <View style={[globalStyles.container, styles.centerContent]}>
      <Text style={globalStyles.title}>摇晃关闭闹钟</Text>

      <View style={styles.progressContainer}>
        <Text style={styles.progressText}>
          进度: {Math.round(progress * 100)}%
        </Text>
        <View style={styles.progressBar}>
          <View style={[styles.progressFill, { width: `${progress * 100}%` }]} />
        </View>
      </View>

      {!isShaking ? (
        <TouchableOpacity
          style={globalStyles.button}
          onPress={startShakeDetection}
        >
          <Text style={globalStyles.buttonText}>开始摇晃</Text>
        </TouchableOpacity>
      ) : (
        <Text style={styles.instruction}>用力摇晃手机20秒!</Text>
      )}

      <TouchableOpacity
        style={[globalStyles.button, styles.snoozeButton]}
        onPress={handleSnooze}
      >
        <Text style={[globalStyles.buttonText, styles.snoozeText]}>贪睡 (-5元)</Text>
      </TouchableOpacity>
    </View>
  );
}
```

### 交付物
- [ ] 传感器权限申请
- [ ] 摇晃检测算法实现
- [ ] 摇晃触发页面完成
- [ ] 进度显示功能

### 验收标准
- 摇晃检测准确率>90%
- 进度显示实时更新
- 完成摇晃后闹钟成功关闭

---

## 💰 阶段6: 贪睡惩罚机制 (20分钟)

### 目标
实现模拟贪睡扣款和记录功能

### 具体任务

#### 6.1 贪睡记录服务 (10分钟)
```javascript
// services/penaltyService.js
import { StorageService } from './storageService';

export class PenaltyService {
  static penaltyAmount = 5; // 固定5元惩罚

  static async recordSnooze(alarmId) {
    const today = new Date().toISOString().split('T')[0];
    let stats = await StorageService.getStats() || {};

    if (!stats[today]) {
      stats[today] = {
        date: today,
        wakeUpSuccess: false,
        snoozeCount: 0,
        penaltyAmount: 0
      };
    }

    stats[today].snoozeCount += 1;
    stats[today].penaltyAmount += this.penaltyAmount;

    await StorageService.saveStats(stats);

    return {
      snoozeCount: stats[today].snoozeCount,
      totalPenalty: stats[today].penaltyAmount
    };
  }

  static async recordWakeUpSuccess() {
    const today = new Date().toISOString().split('T')[0];
    let stats = await StorageService.getStats() || {};

    if (!stats[today]) {
      stats[today] = {
        date: today,
        wakeUpSuccess: true,
        snoozeCount: 0,
        penaltyAmount: 0
      };
    } else {
      stats[today].wakeUpSuccess = true;
    }

    await StorageService.saveStats(stats);
  }
}
```

#### 6.2 更新摇晃触发页面 (10分钟)
```javascript
// 在TriggerScreen.js中添加贪睡处理逻辑
const confirmSnooze = async () => {
  try {
    const result = await PenaltyService.recordSnooze(currentAlarm.id);

    AudioService.stopAlarmSound();

    Alert.alert(
      '贪睡已记录',
      `已记录贪睡 ${result.snoozeCount} 次\n今日累计"扣款": ${result.totalPenalty}元`,
      [{ text: '确定', onPress: () => navigation.navigate('Home') }]
    );

    // 模拟5分钟后重新响铃
    setTimeout(() => {
      navigation.navigate('Trigger');
    }, 5 * 60 * 1000);

  } catch (error) {
    console.error('记录贪睡失败:', error);
  }
};

const handleShakeComplete = async () => {
  await PenaltyService.recordWakeUpSuccess();
  AudioService.stopAlarmSound();

  Alert.alert('成功', '起床成功！今天没有贪睡扣款。', [
    { text: '确定', onPress: () => navigation.navigate('Home') }
  ]);
};
```

### 交付物
- [ ] 贪睡记录服务完成
- [ ] 模拟扣款显示
- [ ] 成功起床记录
- [ ] 数据统计更新

### 验收标准
- 贪睡行为正确记录
- "扣款"金额累计准确
- 成功起床有正向反馈

---

## 📊 阶段7: 统计页面和数据展示 (30分钟)

### 目标
实现用户数据统计和展示功能

### 具体任务

#### 7.1 统计数据计算 (10分钟)
```javascript
// services/statsService.js
import { StorageService } from './storageService';

export class StatsService {
  static async getWeeklyStats() {
    const stats = await StorageService.getStats() || {};
    const today = new Date();
    const weeklyData = [];

    for (let i = 6; i >= 0; i--) {
      const date = new Date(today);
      date.setDate(date.getDate() - i);
      const dateStr = date.toISOString().split('T')[0];

      weeklyData.push({
        date: dateStr,
        dayName: date.toLocaleDateString('zh-CN', { weekday: 'short' }),
        ...stats[dateStr] || {
          wakeUpSuccess: null,
          snoozeCount: 0,
          penaltyAmount: 0
        }
      });
    }

    return weeklyData;
  }

  static async getTotalStats() {
    const stats = await StorageService.getStats() || {};
    let totalPenalty = 0;
    let totalSnoozes = 0;
    let successDays = 0;
    let totalDays = 0;

    Object.values(stats).forEach(day => {
      totalPenalty += day.penaltyAmount || 0;
      totalSnoozes += day.snoozeCount || 0;
      if (day.wakeUpSuccess) successDays++;
      if (day.wakeUpSuccess !== null) totalDays++;
    });

    return {
      totalPenalty,
      totalSnoozes,
      successRate: totalDays > 0 ? (successDays / totalDays * 100).toFixed(1) : 0,
      successDays,
      totalDays
    };
  }
}
```

#### 7.2 统计页面UI (20分钟)
```javascript
// screens/StatsScreen.js
import React, { useState, useEffect } from 'react';
import { View, Text, ScrollView, RefreshControl } from 'react-native';
import { StatsService } from '../services/statsService';

export default function StatsScreen() {
  const [weeklyStats, setWeeklyStats] = useState([]);
  const [totalStats, setTotalStats] = useState({});
  const [refreshing, setRefreshing] = useState(false);

  useEffect(() => {
    loadStats();
  }, []);

  const loadStats = async () => {
    try {
      const weekly = await StatsService.getWeeklyStats();
      const total = await StatsService.getTotalStats();
      setWeeklyStats(weekly);
      setTotalStats(total);
    } catch (error) {
      console.error('加载统计数据失败:', error);
    }
  };

  const onRefresh = async () => {
    setRefreshing(true);
    await loadStats();
    setRefreshing(false);
  };

  const renderWeeklyItem = (item) => (
    <View key={item.date} style={styles.dayItem}>
      <Text style={styles.dayName}>{item.dayName}</Text>
      <View style={[
        styles.statusIndicator,
        { backgroundColor: getStatusColor(item.wakeUpSuccess) }
      ]} />
      <Text style={styles.snoozeCount}>
        {item.snoozeCount > 0 ? `${item.snoozeCount}次` : '-'}
      </Text>
      <Text style={styles.penalty}>
        {item.penaltyAmount > 0 ? `¥${item.penaltyAmount}` : '-'}
      </Text>
    </View>
  );

  const getStatusColor = (success) => {
    if (success === true) return '#4CAF50'; // 绿色 - 成功
    if (success === false) return '#F44336'; // 红色 - 失败
    return '#9E9E9E'; // 灰色 - 无数据
  };

  return (
    <ScrollView
      style={globalStyles.container}
      refreshControl={
        <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />
      }
    >
      <Text style={globalStyles.title}>起床统计</Text>

      {/* 总体统计 */}
      <View style={styles.summaryCard}>
        <Text style={styles.cardTitle}>总体数据</Text>
        <View style={styles.summaryRow}>
          <View style={styles.summaryItem}>
            <Text style={styles.summaryValue}>{totalStats.successRate}%</Text>
            <Text style={styles.summaryLabel}>成功率</Text>
          </View>
          <View style={styles.summaryItem}>
            <Text style={styles.summaryValue}>{totalStats.totalSnoozes}</Text>
            <Text style={styles.summaryLabel}>总贪睡次数</Text>
          </View>
          <View style={styles.summaryItem}>
            <Text style={[styles.summaryValue, styles.penaltyValue]}>
              ¥{totalStats.totalPenalty}
            </Text>
            <Text style={styles.summaryLabel}>累计"扣款"</Text>
          </View>
        </View>
      </View>

      {/* 本周数据 */}
      <View style={styles.weeklyCard}>
        <Text style={styles.cardTitle}>本周记录</Text>
        <View style={styles.weeklyHeader}>
          <Text style={styles.headerText}>日期</Text>
          <Text style={styles.headerText}>状态</Text>
          <Text style={styles.headerText}>贪睡</Text>
          <Text style={styles.headerText}>"扣款"</Text>
        </View>
        {weeklyStats.map(renderWeeklyItem)}
      </View>

      {/* 使用说明 */}
      <View style={styles.infoCard}>
        <Text style={styles.cardTitle}>说明</Text>
        <Text style={styles.infoText}>
          • 绿色: 成功起床，无贪睡{'\n'}
          • 红色: 有贪睡行为{'\n'}
          • 灰色: 无闹钟记录{'\n'}
          • 扣款为模拟显示，不会真实扣费
        </Text>
      </View>
    </ScrollView>
  );
}

const styles = StyleSheet.create({
  summaryCard: {
    backgroundColor: '#1a1a1a',
    borderRadius: 8,
    padding: 20,
    marginVertical: 10,
  },
  cardTitle: {
    color: '#fff',
    fontSize: 18,
    fontWeight: 'bold',
    marginBottom: 15,
  },
  summaryRow: {
    flexDirection: 'row',
    justifyContent: 'space-around',
  },
  summaryItem: {
    alignItems: 'center',
  },
  summaryValue: {
    color: '#fff',
    fontSize: 24,
    fontWeight: 'bold',
  },
  penaltyValue: {
    color: '#F44336',
  },
  summaryLabel: {
    color: '#ccc',
    fontSize: 12,
    marginTop: 5,
  },
  weeklyCard: {
    backgroundColor: '#1a1a1a',
    borderRadius: 8,
    padding: 20,
    marginVertical: 10,
  },
  weeklyHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    paddingBottom: 10,
    borderBottomWidth: 1,
    borderBottomColor: '#333',
    marginBottom: 10,
  },
  headerText: {
    color: '#ccc',
    fontSize: 14,
    fontWeight: 'bold',
    flex: 1,
    textAlign: 'center',
  },
  dayItem: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingVertical: 8,
  },
  dayName: {
    color: '#fff',
    fontSize: 14,
    flex: 1,
    textAlign: 'center',
  },
  statusIndicator: {
    width: 20,
    height: 20,
    borderRadius: 10,
    flex: 1,
    alignSelf: 'center',
  },
  snoozeCount: {
    color: '#fff',
    fontSize: 14,
    flex: 1,
    textAlign: 'center',
  },
  penalty: {
    color: '#F44336',
    fontSize: 14,
    flex: 1,
    textAlign: 'center',
  },
  infoCard: {
    backgroundColor: '#1a1a1a',
    borderRadius: 8,
    padding: 20,
    marginVertical: 10,
  },
  infoText: {
    color: '#ccc',
    fontSize: 14,
    lineHeight: 20,
  },
});
```

### 交付物
- [ ] 统计数据计算服务
- [ ] 周数据可视化
- [ ] 总体数据摘要
- [ ] 数据刷新功能

### 验收标准
- 统计数据计算准确
- 图表显示清晰易懂
- 数据实时更新
- 下拉刷新功能正常

---

## 🔧 阶段8: 整体测试和优化 (30分钟)

### 目标
全面测试应用功能，修复bug，优化用户体验

### 具体任务

#### 8.1 功能测试 (15分钟)
测试清单：
- [ ] 设置闹钟 → 准时触发
- [ ] 摇晃检测 → 进度显示 → 成功关闭
- [ ] 贪睡操作 → 记录数据 → 重新响铃
- [ ] 统计页面 → 数据准确 → 刷新正常
- [ ] 页面导航 → 无卡顿 → 无报错
- [ ] 数据持久化 → 重启应用 → 数据保留

#### 8.2 用户体验优化 (10分钟)
- 添加加载状态
- 优化按钮反馈
- 增加操作确认
- 改善错误提示
- 优化界面响应

#### 8.3 性能优化 (5分钟)
- 减少不必要的重渲染
- 优化传感器监听
- 清理未使用的资源
- 检查内存泄漏

### 交付物
- [ ] 功能测试报告
- [ ] Bug修复完成
- [ ] 用户体验优化
- [ ] 性能优化完成
- [ ] 应用发布准备

### 验收标准
- 所有核心功能正常工作
- 无严重bug和崩溃
- 界面响应流畅
- 可以打包发布

---

## 📋 项目完成检查单

### 核心功能验收
- [ ] **闹钟设置**: 可以创建和保存闹钟
- [ ] **定时触发**: 闹钟准时响起并播放音效
- [ ] **摇晃检测**: 摇晃20秒可关闭闹钟
- [ ] **贪睡惩罚**: 贪睡会显示扣款并记录
- [ ] **数据统计**: 可查看起床记录和"扣款"统计
- [ ] **数据持久**: 应用重启后数据不丢失

### 技术指标验收
- [ ] **响应速度**: 页面切换<500ms
- [ ] **检测精度**: 摇晃检测准确率>90%
- [ ] **稳定性**: 连续使用无崩溃
- [ ] **兼容性**: 支持iOS和Android
- [ ] **资源占用**: 内存使用<100MB

### 用户体验验收
- [ ] **界面友好**: 黑白简约设计
- [ ] **操作简单**: 主要功能3步内完成
- [ ] **反馈及时**: 操作有即时反馈
- [ ] **错误处理**: 异常情况有友好提示

---

## 🚀 后续扩展计划

### 第一次迭代 (完成MVP后)
- 添加GPS距离检测功能
- 实现真实支付系统集成
- 增加更多闹钟铃声
- 支持多个闹钟设置

### 第二次迭代
- 开发后端API服务
- 实现用户账号系统
- 添加云端数据同步
- 增加社交分享功能

### 第三次迭代
- 智能习惯分析
- 个性化建议推荐
- 详细数据图表
- 成就系统和奖励

---

*本多阶段编写计划为5小时MVP开发提供了详细的实施路径，确保在有限时间内完成核心功能的技术验证。*